!function(){var e=Backbone.Model.extend({}),t=new e({name:"Shane"}),n=new e({name:"John"}),i=new e({name:"Peter"}),a=new e({name:"Mike"}),l=Backbone.Collection.extend({model:e}),s=new l([t,n,i,a]);s.on("add",function(){r.render(s)});var u=Backbone.View.extend({template:Handlebars.compile($("#names-template").html()),templateName:Handlebars.compile($("#names-input-template").html()),events:{"submit form":"addName","keydown input":"inputKey","focus input":"inputFocus","blur input":"inputBlur"},initialize:function(){this.$el=$("#names-list"),this.selectedName=1},render:function(e){return 0===this.$el.has("form").length&&(this.$form=this.$el.html(this.templateName()),this.$input=this.$form.find("input"),this.$ul=this.$el.find(".js-user-select-list")),this.$ul.html(this.template({item:e.toJSON()})).children("li:eq(0)").addClass("active"),this},addName:function(t){t.preventDefault();var n=new e({name:this.$input.val()});this.$input.val(""),s.add(n)},inputFocus:function(){this.$ul.show()},inputBlur:function(){this.$ul.hide()},inputKey:function(e){var t=this.$ul.find(".active");if(40===e.keyCode)0!==t.next().length&&t.removeClass("active").next().addClass("active");else if(38===e.keyCode)0!==t.prev().length&&t.removeClass("active").prev().addClass("active");else if(9===e.keyCode)this.$input.val(t.text());else if(13===e.keyCode)e.preventDefault(),this.$input.val(t.text()),this.inputBlur();else{var n=this.$input.val(),i=s.filter(function(e){return e.attributes.name.match(n)});this.render(new l(i))}}}),r=new u({});r.render(s)}();