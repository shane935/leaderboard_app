!function(){function e(){h.render(),r.render()}var t=Backbone.Model.extend({}),n=new t({name:"Shane"}),i=new t({name:"John"}),l=new t({name:"Peter"}),a=new t({name:"Mike"}),s=Backbone.Collection.extend({model:t}),u=new s([n,i,l,a]),o=Backbone.View.extend({events:{submit:"addName"},addName:function(e){e.preventDefault();var t=[];this.$el.find("input").each(function(){$input=$(this),t.push({name:$input.val()}),$input.val("")}),u.add(t),console.log(u)}}),d=Backbone.View.extend({template:Handlebars.compile($("#names-template").html()),templateName:Handlebars.compile($("#names-input-template").html()),events:{"keyup input":"inputKey","focus input":"inputFocus","blur input":"inputBlur"},initialize:function(){this.listenTo(this.collection,"add",this.render)},render:function(e){return e="undefined"==typeof e?this.collection:e,0===this.$el.has("input").length&&(this.$form=this.$el.html(this.templateName()),this.$input=this.$form.find("input"),this.$ul=this.$el.find(".js-user-select-list")),this.$ul.html(this.template({item:e.toJSON()})).children("li:eq(0)").addClass("active"),this},inputFocus:function(){this.$ul.show()},inputBlur:function(){this.$ul.hide()},inputKey:function(e){var t=this.$ul.find(".active");if(40===e.keyCode)0!==t.next().length&&t.removeClass("active").next().addClass("active");else if(38===e.keyCode)0!==t.prev().length&&t.removeClass("active").prev().addClass("active");else if(9===e.keyCode)this.$input.val(t.text());else if(13===e.keyCode)e.preventDefault(),this.$input.val(t.text()),this.inputBlur();else{var n=this.$input.val(),i=u.filter(function(e){return e.attributes.name.match(n)});this.render(new s(i))}}}),c=new o({el:document.getElementById("form")}),h=new d({el:document.getElementById("PlayerOne"),collection:u}),r=new d({el:document.getElementById("PlayerTwo"),collection:u});e()}();